<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui">
<h:body>
	<ui:composition template="/WEB-INF/tags/layout.xhtml">
		<ui:define name="content">

			<h:form id="formSuche">
				<p:growl id="msgs" showDetail="true" />
				<p:panelGrid columns="3">
					<p:fieldset legend="Suchobjekt" style="margin-bottom:20px">
						<h:panelGrid columns="5">
							<p:outputLabel for="suchobjekt" value="Suchobjekt:" />
							<p:selectOneRadio id="suchobjekt" value="#{matchView.suchobjekt}">
								<f:selectItem itemLabel="Skill" itemValue="Skill" />
								<f:selectItem itemLabel="Mitarbeiter" itemValue="Mitarbeiter" />
								<f:selectItem itemLabel="Ausschreibung"
									itemValue="Ausschreibung" />
								<p:ajax event="change" update="formSuche" />
								<f:event type="javax.faces.event.PreRenderViewEvent" listener="#{matchView.preRenderView}"/>
							</p:selectOneRadio>
						</h:panelGrid>
					</p:fieldset>

					<p:fieldset legend="Suchkriterien - Skill" id="fieldsetSkill"
						rendered="#{matchView.suchobjekt == 'Skill'}">
						<h:panelGrid columns="4">
							<p:outputLabel for="skkurz" value="Skill-Kurzbezeichnung:" />
							<p:selectCheckboxMenu id="skkurz"
								value="#{matchView.listSelectedSkills}" label="Skills"
								filter="true" filterMatchMode="startsWith"
								panelStyle="width:250px" converter="#{matchView.skillconverter}">
								<f:selectItems value="#{matchView.listAllSkills}"
									itemLabel="#{sk.kurzbezeichnung}" itemValue="#{skill}" var="sk" />
								<p:ajax event="change" update="formSuche:display"/>
							</p:selectCheckboxMenu>

							<p:outputPanel id="display"
								style="width:250px;padding-left:5px;margin-top:10px">
								<p:dataList value="#{matchView.listSelectedSkills}"
									paginator="true" rows="5" paginatorPosition="top"
									var="skillSelektierte" emptyMessage="Keine Skills ausgewählt">
           						 #{skillSelektierte.kurzbezeichnung}
       							 </p:dataList>
							</p:outputPanel>
						</h:panelGrid>
					</p:fieldset>

					<p:fieldset legend="Suchkriterien - Mitarbeiter"
						id="fieldsetMitarbeiter"
						rendered="#{matchView.suchobjekt == 'Mitarbeiter'}">
						<h:panelGrid columns="6">
							<p:outputLabel for="vorname" value="Vorname" />
							<p:inputText id="vorname"></p:inputText>
							<p:outputLabel for="nachname" value="Nachname" />
							<p:inputText id="nachname"></p:inputText>
							<p:outputLabel for="personalnummer" value="Personalnummer" />
							<p:inputText id="personalnummer"></p:inputText>
						</h:panelGrid>
					</p:fieldset>

					<p:fieldset legend="Suchkriterien - Ausschreibung"
						id="fieldsetAusschreibung"
						rendered="#{matchView.suchobjekt == 'Ausschreibung'}">
						<h:panelGrid columns="6">
							<p:outputLabel for="projektid" value="(Projekt-)ID" />
							<p:inputText id="projektid"></p:inputText>
							<p:outputLabel for="kurzbezeichnung" value="Kurzbezeichnung" />
							<p:inputText id="kurzbezeichnung"></p:inputText>
							<p:outputLabel for="herausgeber" value="Herausgeber" />
							<p:inputText id="herausgeber"></p:inputText>
						</h:panelGrid>
					</p:fieldset>

					<h:panelGrid columns="1" style="border:none">
					<p:commandButton value="Suchen" id="suche" icon="ui-icon-search"
						action="#{matchView.sucheStarten}" update="@all" />
						
						<p:commandButton value="Reset" id="reset" icon="ui-icon-arrowrefresh-1-e"
						action="#{matchView.reset}" update="@all" style="width:98px"/>
					</h:panelGrid>

				</p:panelGrid>
				<p:separator></p:separator>



  <p:tabView>
        <p:tab title="Gefundene Mitarbeiter">
		

				<p:dataTable id="tblskillMIT" var="zuskill"
					value="#{matchView.listeGefundenerMitarbeiterZuSkill}"
					paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} "
					paginator="true" rows="10" style="margin-bottom:20px" paginatorPosition="top"
					rendered="#{matchView.wurdeGesucht and matchView.suchobjekt == 'Skill'}">
					

					<p:column style="width:20px;">
						<f:facet name="header">
							<h:outputText value="Id" />
						</f:facet>
						<h:outputText value="#{zuskill.mitarbeiter.id}" />
					</p:column>

					<p:column>
						<f:facet name="header">
							<h:outputText value="Vorname" />
						</f:facet>
						<h:outputText value="#{zuskill.mitarbeiter.vorname}" />
					</p:column>

					<p:column>
						<f:facet name="header">
							<h:outputText value="Nachname" />
						</f:facet>
						<h:outputText value="#{zuskill.mitarbeiter.nachname}" />
					</p:column>

					<p:column style="width:120px;">
						<f:facet name="header">
							<h:outputText value="Personalnummer" />
						</f:facet>
						<h:outputText value="#{zuskill.mitarbeiter.personalnummer}" />
					</p:column>

					<p:column style="width:80px;">
						<f:facet name="header">
							<h:outputText value="Trefferquote" />
						</f:facet>
						<h:outputText value="#{zuskill.matchProzent}" />
					</p:column>


					<p:column>
						<f:facet name="header">
							<h:outputText value="Trefferskills" />
						</f:facet>
						<p:outputPanel id="display"
							style="width:250px;padding-left:5px;margin-top:10px">
							<p:dataList value="#{zuskill.listGefundenerSkills}"
								paginator="true" rows="3" paginatorPosition="top"
								var="skillSelektierte" emptyMessage="Keine Skills ausgewählt">
           						 #{skillSelektierte.kurzbezeichnung}
       							 </p:dataList>
						</p:outputPanel>
					</p:column>
				</p:dataTable>
				</p:tab>
				
				<p:tab title="Gefundene Ausschreibungen">
						<p:dataTable id="tblskill" var="zuskill"
					value="#{matchView.listeGefundenerAuschreibungenZuSkill}"
					paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} "
					paginator="true" rows="10" paginatorPosition="top" style="margin-bottom:20px"
					rendered="#{matchView.wurdeGesucht and matchView.suchobjekt == 'Skill' and matchView.listeGefundenerAuschreibungenZuSkill.size() != 0}">
					<f:facet name="header">
					Passende Ausschreibungen zum Suchfilter    
					</f:facet>

					<p:column>
						<f:facet name="header">
							<h:outputText value="Id" />
						</f:facet>
						<h:outputText value="#{zuskill.ausschreibung.id}" />
					</p:column>

					<p:column>
						<f:facet name="header">
							<h:outputText value="Kurzbezeichnung" />
						</f:facet>
						<h:outputText value="#{zuskill.ausschreibung.kurzbezeichnung}" />
					</p:column>

					<p:column>
						<f:facet name="header">
							<h:outputText value="Beschreibung" />
						</f:facet>
						<h:outputText value="#{zuskill.ausschreibung.beschreibung}" />
					</p:column>

					<p:column>
						<f:facet name="header">
							<h:outputText value="Herausgeber" />
						</f:facet>
						<h:outputText value="#{zuskill.ausschreibung.herausgeber}" />
					</p:column>
					
				

					<p:column style="width:80px;">
						<f:facet name="header">
							<h:outputText value="Trefferquote" />
						</f:facet>
						<h:outputText value="#{zuskill.matchProzent}" />
					</p:column>
					
						<p:column>
						<f:facet name="header">
							<h:outputText value="Trefferskills" />
						</f:facet>
						<p:outputPanel id="display"
							style="width:250px;padding-left:5px;margin-top:10px">
							<p:dataList value="#{zuskill.listGefundenerSkills}"
								paginator="true" rows="3" paginatorPosition="top"
								var="skillSelektierte" emptyMessage="Keine Skills ausgewählt">
           						 #{skillSelektierte.kurzbezeichnung}
       							 </p:dataList>
						</p:outputPanel>
					</p:column>
				</p:dataTable>

				<h:commandLink id="excel" rendered="#{matchView.wurdeGesucht}">
					<p:graphicImage value="/resources/images/exceldownload.png"
						style="height:35px" />
					<p:dataExporter type="xls" target="tblskill"
						fileName="#{matchView.baueFilename()}"
						postProcessor="#{matchView.postProcessXLS}" />
				</h:commandLink>
				
				</p:tab>
				</p:tabView>





			</h:form>

		</ui:define>
	</ui:composition>

</h:body>
</html>
